-- v1.0
-- Add indexes to core SRG backend tables

USE SRG;
GO

BEGIN TRY
    BEGIN TRANSACTION;

  -- dbo.SRG_CaseDetail
Create index idxRDS_Treatment_Route on dbo.SRG_CaseDetail(RDS_Treatment_Route)
Create index idxBatch on dbo.SRG_CaseDetail(Batch)
Create index idxCurrentStageID on dbo.SRG_CaseDetail(CurrentStageID)
Create index idxCurrentStatusID on dbo.SRG_CaseDetail(CurrentStatusID)
Create index idxCurrentAllocatedToID on dbo.SRG_CaseDetail(CurrentAllocatedToID)
Create index idxRDS_Case_ID_Ref on dbo.SRG_CaseDetail(RDS_Case_ID_Ref)

--dbo.SRG_Customer
Create index idxRDS_Case_ID_Ref on dbo.SRG_Customer(RDS_Case_ID_Ref)
Create index idxRDS_SCV_Key_Ref on dbo.SRG_Customer(RDS_SCV_Key_Ref)
Create index idxCIN on dbo.SRG_Customer(CIN)
Create index idxContact_No on dbo.SRG_Customer(Contact_No)
Create index idxEmail_Address on dbo.SRG_Customer(Email_Address)

--dbo.SRG_Product
Create index idxRDS_Case_ID_Ref on dbo.SRG_Product(RDS_Case_ID_Ref)
Create index idxRDS_AME_Polkey_Ref on dbo.SRG_Product(RDS_AME_Polkey_Ref)
Create index idxRBS_Policy_Number on dbo.SRG_Product(RBS_Policy_Number)
Create index idxProduct_Policy_Number on dbo.SRG_Product(Product_Policy_Number)
Create index idxINV_Ref_No on dbo.SRG_Product(INV_Ref_No)

--dbo.SRG_ProductCustomerGrouping
Create index idxRDS_Case_ID_Ref on dbo.SRG_ProductCustomerGrouping(RDS_Case_ID_Ref)
Create index idxCaseID on dbo.SRG_ProductCustomerGrouping(CaseID)
Create index idxCustomerID on dbo.SRG_ProductCustomerGrouping(CustomerID)
Create index idxProductID on dbo.SRG_ProductCustomerGrouping(ProductID)
Create index idxRDS_SCV_Key_Ref on dbo.SRG_ProductCustomerGrouping(RDS_SCV_Key_Ref)
Create index idxRDS_AME_Polkey_Ref on dbo.SRG_ProductCustomerGrouping(RDS_AME_Polkey_Ref)

--dbo.SRG_CaseHistory
Create index idxCaseID on dbo.SRG_CaseHistory(CaseID)
Create index idxCurrentStage on dbo.SRG_CaseHistory(CurrentStage)
Create index idxCurrentStatus on dbo.SRG_CaseHistory(CurrentStatus)
Create index idxCurrentAllocatedTo on dbo.SRG_CaseHistory(CurrentAllocatedTo)

--dbo.SRG_SRCMaster
Create index idxCaseID on dbo.SRG_SRCMaster(CaseID)

--dbo.SRC_RedressMaster
Create index idxCaseID on dbo.SRC_RedressMaster(CaseID)

--dbo.SRG_SRCSummaryCG
Create index idxSRCMasterID on dbo.SRG_SRCSummaryCG(SRCMasterID)
Create index idxCGID on dbo.SRG_SRCSummaryCG(CGID)
Create index idxAdviceID on dbo.SRG_SRCSummaryCG(AdviceID)
Create index idxOutcomeID on dbo.SRG_SRCSummaryCG(OutcomeID)

--dbo.SRG_SRCSummaryCustomer
Create index idxCustomerID on dbo.SRG_SRCSummaryCustomer(CustomerID)
Create index idxSRCMasterID on dbo.SRG_SRCSummaryCustomer(SRCMasterID)
Create index idxCGID on dbo.SRG_SRCSummaryCustomer(CGID)
Create index idxAdviceID on dbo.SRG_SRCSummaryCustomer(AdviceID)
Create index idxOutcomeID on dbo.SRG_SRCSummaryCustomer(OutcomeID)


--dbo.SRG_SRCSummaryProd
Create index idxProductID on dbo.SRG_SRCSummaryProd(ProductID)
Create index idxSRCMasterID on dbo.SRG_SRCSummaryProd(SRCMasterID)
Create index idxOutcomeID on dbo.SRG_SRCSummaryProd(OutcomeID)

--dbo.SRG_SrcCDAdvice
Create index idxSRCMasterID on dbo.SRG_SrcCDAdvice(SRCMasterID)
Create index idxAdviceID on dbo.SRG_SrcCDAdvice(AdviceID)
Create index idxCaseID on dbo.SRG_SrcCDAdvice(CaseID)


--dbo.SRG_SrcCDCustomer
Create index idxSRCMasterID on dbo.SRG_SrcCDCustomer(SRCMasterID)
Create index idxAdviceID on dbo.SRG_SrcCDCustomer(AdviceID)
Create index idxCaseID on dbo.SRG_SrcCDCustomer(CustomerID)


--dbo.SRG_SrcCDDebt
Create index idxSRCMasterID on dbo.SRG_SrcCDDebt(SRCMasterID)
Create index idxAdviceID on dbo.SRG_SrcCDDebt(SrcCDCustomerID)


--dbo.SRG_SrcCDProduct
Create index idxSRCMasterID on dbo.SRG_SrcCDProduct(SRCMasterID)
Create index idxAdviceID on dbo.SRG_SrcCDProduct(ProductID)

--dbo.SRG_tbl_Users
Create index idxRacf on dbo.SRG_tbl_Users(Racf)
Create index idxAdviceID on dbo.SRG_tbl_Users(UserName)


    -- Commit the transaction if all index creations succeed
    COMMIT;
    PRINT 'All indexes created successfully.';
END TRY
BEGIN CATCH
    -- Rollback the transaction if any error occurs
    ROLLBACK;

    -- Report the error
    PRINT 'Error occurred while creating indexes.';
    PRINT 'Error Number: ' + CAST(ERROR_NUMBER() AS VARCHAR);
    PRINT 'Error Message: ' + ERROR_MESSAGE();
END CATCH;

--------------------------------------------

USE SRG;
GO

BEGIN TRY
    BEGIN TRANSACTION;

    -- Adding primary key to table: SRG_Audit_TransactionalDataCapture
    ALTER TABLE SRG_Audit_TransactionalDataCapture ADD CONSTRAINT PK_SRG_Audit_TransactionalDataCapture PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_AuditSRCMaster
    ALTER TABLE SRG_AuditSRCMaster ADD CONSTRAINT PK_SRG_AuditSRCMaster PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_AuditSRCSummaryCG
    ALTER TABLE SRG_AuditSRCSummaryCG ADD CONSTRAINT PK_SRG_AuditSRCSummaryCG PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_AuditSRCSummaryProd
    ALTER TABLE SRG_AuditSRCSummaryProd ADD CONSTRAINT PK_SRG_AuditSRCSummaryProd PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_Audittbl_UserRoles
    ALTER TABLE SRG_Audittbl_UserRoles ADD CONSTRAINT PK_SRG_Audittbl_UserRoles PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_AuditTriageCTCRag
    ALTER TABLE SRG_AuditTriageCTCRag ADD CONSTRAINT PK_SRG_AuditTriageCTCRag PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_AuditTriageQCRag
    ALTER TABLE SRG_AuditTriageQCRag ADD CONSTRAINT PK_SRG_AuditTriageQCRag PRIMARY KEY (AuditID);

    -- Adding primary key to table: SRG_CaseDetail_InitialLoad
    ALTER TABLE SRG_CaseDetail_InitialLoad ADD CONSTRAINT PK_SRG_CaseDetail_InitialLoad PRIMARY KEY (CaseID);

    -- Adding primary key to table: SRG_Customer_InitialLoad
    ALTER TABLE SRG_Customer_InitialLoad ADD CONSTRAINT PK_SRG_Customer_InitialLoad PRIMARY KEY (CustomerID);

    -- Adding primary key to table: SRG_CustomerAddress_InitialLoad
    ALTER TABLE SRG_CustomerAddress_InitialLoad ADD CONSTRAINT PK_SRG_CustomerAddress_InitialLoad PRIMARY KEY (CustomerAddressID);

    -- Adding primary key to table: SRG_Product_InitialLoad
    ALTER TABLE SRG_Product_InitialLoad ADD CONSTRAINT PK_SRG_Product_InitialLoad PRIMARY KEY (ProductID);

    -- Adding primary key to table: SRG_ProductCustomerGrouping_InitialLoad
    ALTER TABLE SRG_ProductCustomerGrouping_InitialLoad ADD CONSTRAINT PK_SRG_ProductCustomerGrouping_InitialLoad PRIMARY KEY (PgcID);

    -- Adding primary key to table: SRG_SRCMaster
    ALTER TABLE SRG_SRCMaster ADD CONSTRAINT PK_SRG_SRCMaster PRIMARY KEY (SRCMasterID);

    -- Adding primary key to table: SRG_SRCSummaryCG
    ALTER TABLE SRG_SRCSummaryCG ADD CONSTRAINT PK_SRG_SRCSummaryCG PRIMARY KEY (SRCSummaryCGID);

    -- Adding primary key to table: SRG_SRCSummaryProd
    ALTER TABLE SRG_SRCSummaryProd ADD CONSTRAINT PK_SRG_SRCSummaryProd PRIMARY KEY (SRCSummaryProdID);

    -- Adding primary key to table: SRG_tbl_DataImportFields
    ALTER TABLE SRG_tbl_DataImportFields ADD CONSTRAINT PK_SRG_tbl_DataImportFields PRIMARY KEY (DataImportFieldID);--No Idn but unique

    -- Adding primary key to table: SRG_tbl_DataImportTables
    ALTER TABLE SRG_tbl_DataImportTables ADD CONSTRAINT PK_SRG_tbl_DataImportTables PRIMARY KEY (DataImportTableID); -- No Idn but unique

    -- Adding primary key to table: SRG_tbl_DataImportTypes
    ALTER TABLE SRG_tbl_DataImportTypes ADD CONSTRAINT PK_SRG_tbl_DataImportTypes PRIMARY KEY (DataImportTypeID);  ---- No Idn but unique

    -- Adding primary key to table: SRG_tbl_MailingExportTypes
    ALTER TABLE SRG_tbl_MailingExportTypes ADD CONSTRAINT PK_SRG_tbl_MailingExportTypes PRIMARY KEY (MailingExportTypeID); ---- No Idn but unique

    -- Adding primary key to table: SRG_tbl_SRCOutcome
    ALTER TABLE SRG_tbl_SRCOutcome ADD CONSTRAINT PK_SRG_tbl_SRCOutcome PRIMARY KEY (OutcomeID);

    -- Adding primary key to table: SRG_TransactionalDataCapture
    ALTER TABLE SRG_TransactionalDataCapture ADD CONSTRAINT PK_SRG_TransactionalDataCapture PRIMARY KEY (TransID); --Idn Exit

    -- Adding primary key to table: SRG_Transactions_InitialLoad
    ALTER TABLE SRG_Transactions_InitialLoad ADD CONSTRAINT PK_SRG_Transactions_InitialLoad PRIMARY KEY (TransactionID); ---- No Idn but unique

    -- Adding primary key to table: SRG_TriageCTCRag
    ALTER TABLE SRG_TriageCTCRag ADD CONSTRAINT PK_SRG_TriageCTCRag PRIMARY KEY (TriageRAGId); --Idn Exit

    -- Adding primary key to table: SRG_TriageQCRag
    ALTER TABLE SRG_TriageQCRag ADD CONSTRAINT PK_SRG_TriageQCRag PRIMARY KEY (TriageRAGId); --Idn Exit

    COMMIT TRANSACTION;
END TRY
BEGIN CATCH
    ROLLBACK TRANSACTION;

    PRINT 'Error occurred while adding primary keys.';
    PRINT ERROR_MESSAGE();
END CATCH;


















-----------------------------------------
